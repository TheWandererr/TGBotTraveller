<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id='2020_04_04_create_TGBotTraveller_database.xml' author="Artyom Konashchenko">

        <sql>
            CREATE TABLE IF NOT EXISTS public."city"
            (
            city_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
            name character varying(64) NOT NULL,
            country character varying(64) NOT NULL,
            photo_url character varying(255) NOT NULL,
            PRIMARY KEY (city_id),
            UNIQUE(name, country)
            );

            CREATE TABLE IF NOT EXISTS public."city_places"
            (
            place_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
            city_id bigint NOT NULL,
            place_name character varying(255) NOT NULL,
            description character varying(255) NOT NULL,
            CONSTRAINT city FOREIGN KEY (city_id)
            REFERENCES public."city" (city_id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE CASCADE
            );

            CREATE TABLE IF NOT EXISTS public."city_params"
            (
            city_params_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
            city_id bigint NOT NULL,
            population bigint NOT NULL,
            square double precision NOT NULL,
            PRIMARY KEY (city_params_id),
            FOREIGN KEY (city_id)
            REFERENCES public."city" (city_id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE CASCADE
            );

        </sql>

    </changeSet>

</databaseChangeLog>
